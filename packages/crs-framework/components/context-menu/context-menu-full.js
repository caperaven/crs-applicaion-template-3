import"./../filter-header/filter-header.js";import{buildElements as i}from"./utils/build-elements.js";import{handleSelection as n}from"./utils/select-item-handler.js";class l extends crs.classes.BindableElement{#e;#n;#s;#l;#o;#i;#c=this.#h.bind(this);#a=this.#r.bind(this);#t;get shadowDom(){return!0}get html(){return import.meta.url.replace(".js",".html")}async connectedCallback(){super.connectedCallback()}async load(){return new Promise(async t=>{requestAnimationFrame(async()=>{this.shadowRoot.addEventListener("click",this.#c),await i.call(this,this.#e,this.#i,this.#s,this.container),this.#t=this.shadowRoot.querySelector("filter-header"),this.#t.addEventListener("close",this.#a),this.#t.container=this.container,await crs.call("component","notify_ready",{element:this}),t()})})}async disconnectedCallback(){this.shadowRoot.removeEventListener("click",this.#c),this.#t.removeEventListener("close",this.#a),this.#e=null,this.#n=null,this.#s=null,this.#l=null,this.#o=null,this.#i=null,this.#t.container=null,this.#t=null,super.disconnectedCallback()}async#r(){await crs.call("context_menu","close")}async#h(t){if(t.composedPath()[0]===this.btnBack)return this.#u();if(await n(t,this.#e,this,this.#t),this.btnBack==null)return;const e=this.shadowRoot.querySelectorAll(".parent-menu-item[aria-expanded='true']");if(e.length>0?this.btnBack.classList.contains("visible")||this.btnBack.classList.add("visible"):this.btnBack.classList.remove("visible"),e.length>0){const s=e[e.length-1].querySelector("ul");this.#t.container=s}else this.#t.container=this.container}#u(){const t=this.shadowRoot.querySelectorAll(".parent-menu-item[aria-expanded='true']");t[t.length-1].removeAttribute("aria-expanded"),t.length==1&&this.btnBack.classList.remove("visible")}setOptions(t){if(this.#e=t.options,this.#n=t.target,this.#s=t.context,this.#l=t.process,this.#o=t.item,this.#i=t.templates,t.style!=null)for(const e of Object.keys(t.style))this.style.setProperty(e,t.style[e])}}customElements.define("context-menu",l);
